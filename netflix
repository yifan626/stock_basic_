# Importing necessary libraries
import numpy as np
import pandas as pd
from pandas import Series, DataFrame
from sklearn import datasets, linear_model
from sklearn.model_selection import train_test_split
import pickle

# Reading the data
df = pd.read_csv(r'/Users/yifanli/Downloads/netflix.csv')
print(df.head())
used_features = ["High", "Low", "Open", "Volume"]
X = df[used_features]
y = df["Close_Last"]

X_train, X_test, y_train, y_test = train_test_split(
    X,
    y,
    test_size=0.3,
    random_state=0,
)

model = linear_model.LinearRegression()

model.fit(X_train, y_train)

#stocks_y_pred = model.predict(X_test)

f = open('/Users/yifanli/Downloads/stock_model.pkl', 'wb')
pickle.dump(model, f)
f.close()

print("模型保存成功")
